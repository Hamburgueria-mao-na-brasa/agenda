<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#101010">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Agenda Minimalista - Creative & Taste</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="image_1ffae0.jpg">
    <link rel="icon" href="image_1ffae0.jpg">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #101010; /* Cinza Grafite Quase Preto */
            --card: #181818; /* Pain√©is sutis */
            --accent: #b08d57; /* Dourado Ocre Sofisticado */
            --text: #e0e0e0; /* Branco Gelo Confort√°vel */
            --text-secondary: #888888;
            --border: #252525; /* Bordas muito finas */
            --urgent: #cc3333; /* Vermelho discreto */
            --concluido: #404040;
        }

        * { box-sizing: border-box; font-family: 'Inter', system-ui, sans-serif; }
        body { margin: 0; background: var(--bg); color: var(--text); padding: 15px; }

        .layout { display: grid; grid-template-columns: 320px 1fr 300px; gap: 20px; max-width: 1600px; margin: auto; }

        /* Pain√©is Minimalistas */
        .box { 
            background: var(--card); 
            border: 1px solid var(--border); 
            border-radius: 8px; /* Cantos suaves */
            padding: 20px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.2); 
            transition: all 0.2s ease;
        }

        h3 { 
            margin-top: 0; 
            color: var(--accent); 
            font-size: 0.9rem; 
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            border-bottom: 1px solid var(--border); 
            padding-bottom: 12px; 
            display: flex; align-items: center; gap: 10px;
        }

        /* Inputs e Bot√µes Minimalistas */
        input, textarea, select, button { 
            width: 100%; padding: 12px; margin-bottom: 12px; border-radius: 4px; 
            border: 1px solid var(--border); 
            background: rgba(255, 255, 255, 0.03); 
            color: var(--text); 
            outline: none;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        input:focus, textarea:focus, select:focus { 
            border-color: var(--accent); 
            background: rgba(255, 255, 255, 0.05);
        }

        /* Bot√£o Premium */
        button { 
            background: var(--accent); 
            color: #101010; 
            font-weight: 600; 
            border: none; 
            cursor: pointer; 
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.85rem;
            transition: opacity 0.2s;
        }
        button:hover { opacity: 0.9; }
        button:active { transform: scale(0.98); }

        /* Calend√°rio Limpo */
        .cal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
        .day { 
            background: transparent; padding: 10px; min-height: 80px; border-radius: 4px; 
            cursor: pointer; position: relative; font-size: 0.9rem; border: 1px solid transparent;
            color: var(--text-secondary);
            transition: all 0.2s;
        }
        .day:hover { background: rgba(255,255,255,0.03); }
        .today { border: 1px solid var(--accent) !important; color: var(--accent); }
        .selected { 
            background: rgba(176, 141, 87, 0.1) !important; 
            border: 1px solid var(--accent) !important; 
            color: var(--accent);
            font-weight: 600;
        }
        
        .dot { height: 4px; width: 4px; background: var(--accent); border-radius: 50%; position: absolute; bottom: 8px; right: 8px; }

        /* Lista de Compromissos Minimalista */
        .item { 
            background: rgba(255, 255, 255, 0.02); padding: 15px; border-radius: 4px; margin-bottom: 12px; 
            display: flex; flex-direction: column; gap: 8px; border: 1px solid var(--border);
            transition: 0.2s;
        }
        .item:hover { border-color: #303030; }
        
        .item.urgente { border-left: 3px solid var(--urgent); }
        .item.concluido { opacity: 0.2; text-decoration: line-through; filter: grayscale(1); }
        
        .item-content { color: var(--text); font-size: 0.95rem; }
        .item-time-prioridade { display: flex; justify-content: space-between; align-items: center; font-size: 0.8rem; color: var(--text-secondary); }
        .item-time { color: var(--accent); font-weight: 600; }

        .btn-check { width: auto; background: none; color: var(--accent); border: 1px solid var(--accent); padding: 4px 8px; font-size: 0.75rem; margin: 0; }
        .btn-check:hover { background: var(--accent); color: #101010; }

        #notasArea { height: 180px; resize: none; border-style: dashed; }

        /* Responsividade para Celular */
        @media (max-width: 1000px) { 
            .layout { grid-template-columns: 1fr; }
            .day { min-height: 60px; padding: 5px; }
        }
    </style>
</head>
<body>

<div class="layout">
    <div class="box">
        <h3>‚ûï Novo Registro</h3>
        <input type="date" id="data">
        <input type="time" id="hora">
        <input type="text" id="titulo" placeholder="Cliente ou Servi√ßo">
        <select id="prioridade">
            <option value="normal">üë§ Pessoal</option>
            <option value="importante">üì∏ Foto_Pro</option>
            <option value=" burger">üçî M√£o na Brasa</option>
            <option value="video">üé• V√≠deo / Reels</option>
            <option value="urgente">üî• Urgente</option>
        </select>
        <textarea id="obs" placeholder="Detalhes importantes..."></textarea>
        <button onclick="adicionar()">Salvar na Agenda</button>
        <button id="installBtn" style="display:none; margin-top:10px; background:#444; color:white;">üì• Instalar App</button>
        
        <div style="margin-top: 25px;">
            <h3>üìù Notas R√°pidas</h3>
            <textarea id="notasArea" placeholder="Anota√ß√µes vol√°teis..." oninput="salvarNotas()"></textarea>
        </div>
    </div>

    <div class="box">
        <div class="cal-header">
            <button onclick="mudarMes(-1)" style="width: auto; background:none; color:var(--text)">‚óÄ</button>
            <h2 id="mesAno" style="margin:0; font-size: 1rem; text-transform:uppercase; letter-spacing:1px;"></h2>
            <button onclick="mudarMes(1)" style="width: auto; background:none; color:var(--text)">‚ñ∂</button>
        </div>
        <div class="grid" id="calendario"></div>
    </div>

    <div class="box">
        <h3 id="tituloLista">üìÖ Compromissos do Dia</h3>
        <div id="listaTarefas"></div>
    </div>
</div>

<audio id="notifSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

<script>
    let agenda = JSON.parse(localStorage.getItem("agendaPessoal")) || [];
    let notas = localStorage.getItem("notasPessoais") || "";
    let hoje = new Date();
    let mesAtual = hoje.getMonth();
    let anoAtual = hoje.getFullYear();
    let dataSelecionada = hoje.toISOString().split('T')[0];

    document.getElementById("notasArea").value = notas;
    document.getElementById("data").value = dataSelecionada;

    // Registro do Service Worker
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js').catch(err => console.log("Erro SW:", err));
    }

    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');

    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        installBtn.style.display = 'block';
    });

    installBtn.addEventListener('click', () => {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then((choice) => {
                if (choice.outcome === 'accepted') installBtn.style.display = 'none';
                deferredPrompt = null;
            });
        }
    });

    function salvar() {
        localStorage.setItem("agendaPessoal", JSON.stringify(agenda));
        gerarCalendario();
        mostrarDia(dataSelecionada);
    }

    function salvarNotas() {
        localStorage.setItem("notasPessoais", document.getElementById("notasArea").value);
    }

    function adicionar() {
        const data = document.getElementById("data").value;
        const titulo = document.getElementById("titulo").value;
        if(!data || !titulo) return alert("Preencha data e t√≠tulo!");
        agenda.push({ id: Date.now(), data, hora: document.getElementById("hora").value, titulo, prioridade: document.getElementById("prioridade").value, obs: document.getElementById("obs").value, concluido: false, notificado: false });
        salvar();
        document.getElementById("titulo").value = "";
        document.getElementById("obs").value = "";
    }

    function toggleConcluir(id) {
        let tarefa = agenda.find(a => a.id === id);
        tarefa.concluido = !tarefa.concluido;
        salvar();
    }

    function excluir(id) {
        if(confirm("Deseja apagar este lembrete?")) { agenda = agenda.filter(a => a.id !== id); salvar(); }
    }

    function mudarMes(v) { 
        mesAtual += v; 
        if(mesAtual > 11) { mesAtual = 0; anoAtual++; }
        if(mesAtual < 0) { mesAtual = 11; anoAtual--; }
        gerarCalendario(); 
    }

    function gerarCalendario() {
        const cal = document.getElementById("calendario");
        const nomes = ["JAN","FEV","MAR","ABR","MAI","JUN","JUL","AGO","SET","OUT","NOV","DEZ"];
        document.getElementById("mesAno").innerText = `${nomes[mesAtual]} [${anoAtual}]`;
        cal.innerHTML = "";
        const primDia = new Date(anoAtual, mesAtual, 1).getDay();
        const diasNoMes = new Date(anoAtual, mesAtual + 1, 0).getDate();
        for (let i = 0; i < primDia; i++) cal.innerHTML += "<div></div>";
        for (let dia = 1; dia <= diasNoMes; dia++) {
            const dataStr = `${anoAtual}-${String(mesAtual+1).padStart(2,'0')}-${String(dia).padStart(2,'0')}`;
            const temCoisa = agenda.some(a => a.data === dataStr && !a.concluido);
            const div = document.createElement("div");
            div.className = "day" + (dataStr === dataSelecionada ? " selected" : "");
            if (dataStr === hoje.toISOString().split('T')[0]) div.classList.add("today");
            div.innerHTML = `<b>${dia}</b>`;
            if (temCoisa) div.innerHTML += `<span class="dot"></span>`;
            div.onclick = () => { dataSelecionada = dataStr; gerarCalendario(); mostrarDia(dataStr); };
            cal.appendChild(div);
        }
    }

    function mostrarDia(data) {
        const lista = document.getElementById("listaTarefas");
        const itens = agenda.filter(a => a.data === data).sort((a,b) => a.hora.localeCompare(b.hora));
        document.getElementById("tituloLista").innerHTML = `üìÖ Dia ${data.split("-").reverse().join(".")}`;
        lista.innerHTML = itens.length ? "" : "<p style='text-align:center; color:#555; font-size:0.8rem;'>Dia Livre</p>";
        itens.forEach(i => {
            lista.innerHTML += `
                <div class="item ${i.prioridade} ${i.concluido ? 'concluido' : ''}">
                    <div class="item-time-prioridade">
                        <span class="item-time">${i.hora || '--:--'}</span>
                        <span>${i.prioridade.toUpperCase()}</span>
                    </div>
                    <div class="item-content">
                        <b>${i.titulo}</b>
                        ${i.obs ? `<div style="font-size:0.8rem; color:#888; margin-top:4px;">${i.obs}</div>` : ''}
                    </div>
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-top:8px;">
                        <button class="btn-check" onclick="toggleConcluir(${i.id})">${i.concluido ? 'üîô REABRIR' : '‚úÖ CONCLUIR'}</button>
                        <button onclick="excluir(${i.id})" style="width:auto; background:none; color:var(--urgent); border:none; padding:4px; font-size:0.8rem;">üóëÔ∏è APAGAR</button>
                    </div>
                </div>`;
        });
    }

    // Sistema de Notifica√ß√µes
    setInterval(() => {
        const agora = new Date();
        const horaAtual = agora.getHours().toString().padStart(2, '0') + ":" + agora.getMinutes().toString().padStart(2, '0');
        const dataHoje = agora.toISOString().split('T')[0];
        agenda.forEach(t => {
            if (!t.concluido && !t.notificado && t.data === dataHoje && t.hora === horaAtual) {
                if (Notification.permission === "granted") new Notification("‚è∞ Lembrete: " + t.titulo);
                document.getElementById("notifSound").play().catch(() => {});
                t.notificado = true;
                localStorage.setItem("agendaPessoal", JSON.stringify(agenda));
            }
        });
    }, 30000);

    gerarCalendario();
    mostrarDia(dataSelecionada);
</script>
</body>
</html>
